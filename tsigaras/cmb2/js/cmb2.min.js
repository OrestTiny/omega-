"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.CMB2=window.CMB2||{},function(n,d,s,b){function l(e){return s(d.getElementById(e))}function m(e,t){return(e=e.split("-")).splice(e.length-1,1),e.push(t),e.join("-")}var i,p=n.cmb2_l10,u=n.setTimeout;b.$id=l;var a={idNumber:!1,repeatEls:'input:not([type="button"]),select,textarea,.cmb2-media-status',noEmpty:'input:not([type="button"]):not([type="radio"]):not([type="checkbox"]),textarea',repeatUpdate:'input:not([type="button"]),select,textarea,label',styleBreakPoint:450,mediaHandlers:{},defaults:{time_picker:p.defaults.time_picker,date_picker:p.defaults.date_picker,color_picker:p.defaults.color_picker||{},code_editor:p.defaults.code_editor},media:{frames:{}}};b.init=function(){i=s(d),s.extend(b,a),b.trigger("cmb_pre_init");var e=b.metabox(),t=e.find(".cmb-repeatable-group");b.initPickers(e.find('input[type="text"].cmb2-timepicker'),e.find('input[type="text"].cmb2-datepicker'),e.find('input[type="text"].cmb2-colorpicker')),b.initCodeEditors(e.find(".cmb2-textarea-code:not(.disable-codemirror)")),s('<p><span class="button-secondary cmb-multicheck-toggle">'+p.strings.check_toggle+"</span></p>").insertBefore(".cmb2-checkbox-list:not(.no-select-all)"),b.makeListSortable(),b.makeRepeatableSortable(),e.on("change",".cmb2_upload_file",function(){b.media.field=s(this).attr("id"),l(b.media.field+"_id").val("")}).on("click",".cmb-multicheck-toggle",b.toggleCheckBoxes).on("click",".cmb2-upload-button",b.handleMedia).on("click",".cmb-attach-list li, .cmb2-media-status .img-status img, .cmb2-media-status .file-status > span",b.handleFileClick).on("click",".cmb2-remove-file-button",b.handleRemoveMedia).on("click",".cmb-add-group-row",b.addGroupRow).on("click",".cmb-add-row-button",b.addAjaxRow).on("click",".cmb-remove-group-row",b.removeGroupRow).on("click",".cmb-remove-row-button",b.removeAjaxRow).on("keyup paste focusout",".cmb2-oembed",b.maybeOembed).on("cmb2_remove_row",".cmb-repeatable-group",b.resetTitlesAndIterator).on("click",".cmbhandle, .cmbhandle + .cmbhandle-title",b.toggleHandle),t.length&&t.on("cmb2_add_row",b.emptyValue).on("cmb2_add_row",b.setDefaults).filter(".sortable").each(function(){s(this).find(".cmb-remove-group-row-button").before('<a class="button-secondary cmb-shift-rows move-up alignleft" href="#"><span class="'+p.up_arrow_class+'"></span></a> <a class="button-secondary cmb-shift-rows move-down alignleft" href="#"><span class="'+p.down_arrow_class+'"></span></a>')}).on("click",".cmb-shift-rows",b.shiftRows),u(b.resizeoEmbeds,500),s(n).on("resize",b.resizeoEmbeds),l("addtag").length&&b.listenTagAdd(),s(d).on("cmb_init",b.mceEnsureSave),b.trigger("cmb_init")},b.mceEnsureSave=function(){wp.data&&wp.data.hasOwnProperty("subscribe")&&b.canTinyMCE()&&wp.data.subscribe(function(){var e=wp.data.hasOwnProperty("select")?wp.data.select("core/editor"):null;if(e&&e.isSavingPost&&e.isSavingPost()&&n.tinyMCE.editors.length)for(var t=0;t<n.tinyMCE.editors.length;t++)n.tinyMCE.activeEditor!==n.tinyMCE.editors[t]&&n.tinyMCE.editors[t].save()})},b.canTinyMCE=function(){return p.user_can_richedit&&n.tinyMCE},b.listenTagAdd=function(){i.ajaxSuccess(function(e,t,i){i.data&&i.data.length&&-1!==i.data.indexOf("action=add-tag")&&b.resetBoxes(l("addtag").find(".cmb2-wrap > .cmb2-metabox"))})},b.resetBoxes=function(e){s.each(e,function(){b.resetBox(s(this))})},b.resetBox=function(e){e.find(".wp-picker-clear").trigger("click"),e.find(".cmb2-remove-file-button").trigger("click"),e.find(".cmb-row.cmb-repeatable-grouping:not(:first-of-type) .cmb-remove-group-row").click(),e.find(".cmb-repeat-row:not(:first-child)").remove(),e.find('input:not([type="button"]),select,textarea').each(function(){var e=s(this),t=e.prop("tagName");if("INPUT"===t){var i=e.attr("type");"checkbox"===i||"radio"===i?e.prop("checked",!1):e.val("")}"SELECT"===t&&s("option:selected",this).prop("selected",!1),"TEXTAREA"===t&&e.html("")})},b.resetTitlesAndIterator=function(e){if(e.group){var t=s(e.target),a=t.find(".cmb-add-group-row").data("grouptitle");t.find(".cmb-repeatable-grouping").each(function(e){var t=s(this),i=parseInt(t.data("iterator"),10);i!==e&&(t.attr("data-iterator",e).data("iterator",e).attr("id",m(t.attr("id"),e)).find(b.repeatEls).each(function(){b.updateNameAttr(s(this),i,e)}),b.resetGroupTitles(t,e,a))})}},b.resetGroupTitles=function(e,t,i){if(i){var a=e.find("h3.cmb-group-title");a.length&&a.text(i.replace("{#}",parseInt(t,10)+1))}},b.toggleHandle=function(e){e.preventDefault(),b.trigger("postbox-toggled",s(this).parent(".postbox").toggleClass("closed"))},b.toggleCheckBoxes=function(e){e.preventDefault();var t=s(this),i=t.closest(".cmb-td").find("input[type=checkbox]:not([disabled])");t.data("checked")?(i.prop("checked",!1),t.data("checked",!1)):(i.prop("checked",!0),t.data("checked",!0))},b.handleMedia=function(e){e.preventDefault();var t=s(this);b.attach_id=!t.hasClass("cmb2-upload-list")&&t.closest(".cmb-td").find(".cmb2-upload-file-id").val(),b.attach_id="0"!==b.attach_id&&b.attach_id,b.handleFieldMedia(t.prev("input.cmb2-upload-file"),t.hasClass("cmb2-upload-list"))},b.handleFileClick=function(e){if(!s(e.target).is("a")){e.preventDefault();var t=s(this),i=t.closest(".cmb-td"),a=i.find(".cmb2-upload-button").hasClass("cmb2-upload-list");b.attach_id=a?t.find('input[type="hidden"]').data("id"):i.find(".cmb2-upload-file-id").val(),b.attach_id&&b.handleFieldMedia(i.find("input.cmb2-upload-file"),a)}},b._handleMedia=function(e,t){return b.handleFieldMedia(l(e),t)},b.handleFieldMedia=function(e,i){if(wp){var c,r,t=e.attr("id"),a=e.data(),n=a.mediaid;if(n||(n=_.uniqueId(),e.attr("data-mediaid",n).data("mediaid",n),a.mediaid=n),r=b.mediaHandlers,(c=b.media).mediaid=n,c.field=t,c.$field=e,c.fieldData=a,c.previewSize=c.fieldData.previewsize,c.sizeName=c.fieldData.sizename,c.fieldName=e.attr("name"),c.isList=i,n in c.frames)return c.frames[n].open();c.frames[n]=wp.media({title:b.metabox().find('label[for="'+t+'"]').text(),library:c.fieldData.queryargs||{},button:{text:p.strings[i?"upload_files":"upload_file"]},multiple:!!i&&"add"}),c.frames[n].states.first().set("filterable","all"),b.trigger("cmb_media_modal_init",c),r.list=function(e,t){var i,a=[];if(r.list.templates||(r.list.templates={image:wp.template("cmb2-list-image"),file:wp.template("cmb2-list-file")}),e.each(function(e){i=r.getAttachmentHtml(e,"list"),a.push(i)}),t)return a;c.$field.siblings(".cmb2-media-status").append(a)},r.single=function(e){r.single.templates||(r.single.templates={image:wp.template("cmb2-single-image"),file:wp.template("cmb2-single-file")});var t=e.first();c.$field.val(t.get("url")),c.$field.closest(".cmb-td").find(".cmb2-upload-file-id").val(t.get("id"));var i=r.getAttachmentHtml(t,"single");c.$field.siblings(".cmb2-media-status").slideDown().html(i)},r.getAttachmentHtml=function(e,t){var i="image"===e.get("type"),a=r.prepareData(e,i);return r[t].templates[i?"image":"file"](a)},r.prepareData=function(e,t){return t&&r.getImageData.call(e,50),(e=e.toJSON()).mediaField=c.field,e.mediaFieldName=c.fieldName,e.stringRemoveImage=p.strings.remove_image,e.stringFile=p.strings.file,e.stringDownload=p.strings.download,e.stringRemoveFile=p.strings.remove_file,e},r.getImageData=function(e){var t=c.previewSize[0]||e,i=c.previewSize[1]||e,a=this.get("url"),r=this.get("width"),n=this.get("height"),o=this.get("sizes");return o&&(o[c.sizeName]?(a=o[c.sizeName].url,r=o[c.sizeName].width,n=o[c.sizeName].height):o.large&&(a=o.large.url,r=o.large.width,n=o.large.height)),t<r&&(n=Math.floor(t*n/r),r=t),i<n&&(r=Math.floor(i*r/n),n=i),r=r||t,n=n||("svg"===this.get("filename").split(".").pop()?"100%":i),this.set("sizeUrl",a),this.set("sizeWidth",r),this.set("sizeHeight",n),this},r.selectFile=function(){var e=c.frames[n].state().get("selection"),t=i?"list":"single";b.attach_id&&i?s('[data-id="'+b.attach_id+'"]').parents("li").replaceWith(r.list(e,!0)):r[t](e),b.trigger("cmb_media_modal_select",e,c)},r.openModal=function(){var e,t=c.frames[n].state().get("selection");b.attach_id?((e=wp.media.attachment(b.attach_id)).fetch(),t.set(e?[e]:[])):t.reset(),b.trigger("cmb_media_modal_open",t,c)},c.frames[n].on("select",r.selectFile).on("open",r.openModal),c.frames[n].open()}},b.handleRemoveMedia=function(e){e.preventDefault();var t=s(this);if(t.is(".cmb-attach-list .cmb2-remove-file-button"))return t.parents(".cmb2-media-item").remove(),!1;var i=t.closest(".cmb-td");return b.media.$field=i.find(".cmb2-upload-file"),b.media.field=b.media.$field.attr("id"),b.media.$field.val(""),i.find(".cmb2-upload-file-id").val(""),t.parents(".cmb2-media-status").html(""),!1},b.cleanRow=function(r,n,e){var t=r.find(b.repeatUpdate);if(e){var i=r.find("[id]").not(b.repeatUpdate);r.find(".cmb-repeat-table .cmb-repeat-row:not(:first-child)").remove(),i.length&&i.each(function(){var e=s(this),t=e.attr("id"),i=t.replace("_"+n,"_"+b.idNumber),a=r.find('[data-selector="'+t+'"]');e.attr("id",i),a.length&&a.attr("data-selector",i).data("selector",i)})}return t.filter(":checked").removeAttr("checked"),t.find(":checked").removeAttr("checked"),t.filter(":selected").removeAttr("selected"),t.find(":selected").removeAttr("selected",!1),b.resetGroupTitles(r,b.idNumber,r.data("title")),t.each(function(){b.elReplacements(s(this),n,e)}),b},b.elReplacements=function(e,t,i){var a,r=e.attr("for"),n=e.val(),o=e.prop("type"),c=b.getFieldArg(e,"default"),d=void 0!==c&&!1!==c?c:"",s=e.prop("tagName"),l=("radio"===o||"checkbox"===o)&&n,m={};if(r)m={for:r.replace("_"+t,"_"+b.idNumber)};else{var p,u=e.attr("name");a=e.attr("id"),m={id:i?(p=u?u.replace("["+t+"][","["+b.idNumber+"]["):"",a?a.replace("_"+t+"_","_"+b.idNumber+"_"):""):(p=u?b.replaceLast(u,"["+t+"]","["+b.idNumber+"]"):"",a?b.replaceLast(a,"_"+t,"_"+b.idNumber):""),name:p}}if("TEXTAREA"===s&&e.html(d),"SELECT"===s&&void 0!==c){var f=e.find('[value="'+c+'"]');f.length&&f.attr("selected","selected").prop("selected","selected")}return l&&(e.removeAttr("checked"),void 0!==c&&n===c&&e.attr("checked","checked").prop("checked","checked")),!i&&e[0].hasAttribute("data-iterator")&&(m["data-iterator"]=b.idNumber),e.removeClass("hasDatepicker").val(l||d).attr(m),e},b.newRowHousekeeping=function(e){var t=e.find(".wp-picker-container"),i=e.find(".cmb2-media-status");return t.length&&t.each(function(){var e=s(this).parent();e.html(e.find('input[type="text"].cmb2-colorpicker').attr("style",""))}),i.length&&i.empty(),b},b.afterRowInsert=function(e){b.initPickers(e.find('input[type="text"].cmb2-timepicker'),e.find('input[type="text"].cmb2-datepicker'),e.find('input[type="text"].cmb2-colorpicker'))},b.updateNameAttr=function(e,t,i){var a=e.attr("name");if(void 0!==a){var r=e.attr("id").indexOf("filelist"),n=r?"["+t+"][":"["+t+"]",o=r?"["+i+"][":"["+i+"]",c=a.replace(n,o);e.attr("name",c)}},b.emptyValue=function(e,t){s(b.noEmpty,t).val("")},b.setDefaults=function(e,t){s(b.noEmpty,t).each(function(){var e=s(this),t=b.getFieldArg(e,"default");void 0!==t&&!1!==t&&e.val(t)})},b.addGroupRow=function(e){e.preventDefault();var t=s(this);b.triggerElement(t,"cmb2_add_group_row_start",t);var i=l(t.data("selector")),a=i.find(".cmb-repeatable-grouping").last(),r=parseInt(a.data("iterator"),10);b.idNumber=parseInt(r,10)+1;for(var n=a.clone(),o=n.prop("nodeName")||"div";0<i.find('.cmb-repeatable-grouping[data-iterator="'+b.idNumber+'"]').length;)b.idNumber++;b.newRowHousekeeping(n.data("title",t.data("grouptitle"))).cleanRow(n,r,!0),n.find(".cmb-add-row-button").prop("disabled",!1);var c=s("<"+o+' id="'+m(a.attr("id"),b.idNumber)+'" class="postbox cmb-row cmb-repeatable-grouping" data-iterator="'+b.idNumber+'">'+n.html()+"</"+o+">");a.after(c),b.afterRowInsert(c),b.makeRepeatableSortable(c),b.triggerElement(i,{type:"cmb2_add_row",group:!0},c)},b.addAjaxRow=function(e){e.preventDefault();var t=s(this),i=l(t.data("selector")),a=i.find(".empty-row"),r=parseInt(a.find("[data-iterator]").data("iterator"),10);b.idNumber=parseInt(r,10)+1;var n=a.clone();b.newRowHousekeeping(n).cleanRow(n,r),a.removeClass("empty-row hidden").addClass("cmb-repeat-row"),a.after(n),b.afterRowInsert(n),b.triggerElement(i,{type:"cmb2_add_row",group:!1},n,a)},b.removeGroupRow=function(e){e.preventDefault();var t=s(this),i=t.data("confirm");if(b.resetRow.resetting||!i||n.confirm(i)){var a=l(t.data("selector")),r=t.parents(".cmb-repeatable-grouping");if(a.find(".cmb-repeatable-grouping").length<2)return b.resetRow(r.parents(".cmb-repeatable-group").find(".cmb-add-group-row"),t);b.triggerElement(a,"cmb2_remove_group_row_start",t),r.remove(),b.triggerElement(a,{type:"cmb2_remove_row",group:!0})}},b.removeAjaxRow=function(e){e.preventDefault();var t=s(this);if(!t.hasClass("button-disabled")){var i=t.parents(".cmb-row"),a=t.parents(".cmb-repeat-table");if(a.find(".cmb-row").length<=2)return b.resetRow(i.find(".cmb-add-row-button"),t);i.hasClass("empty-row")&&i.prev().addClass("empty-row").removeClass("cmb-repeat-row"),t.parents(".cmb-repeat-table .cmb-row").remove(),b.triggerElement(a,{type:"cmb2_remove_row",group:!1})}},b.resetRow=function(e,t){b.resetRow.resetting=!0,e.trigger("click"),t.trigger("click"),b.resetRow.resetting=!1},b.shiftRows=function(e){e.preventDefault();var t=s(this),i=!!t.hasClass("move-up"),a=t.parents(".cmb-repeatable-grouping"),r=a[i?"prev":"next"](".cmb-repeatable-grouping");if(b.triggerElement(t,"cmb2_shift_rows_enter",t,a,r),r.length){b.triggerElement(t,"cmb2_shift_rows_start",t,a,r);var n=a.attr("data-iterator"),o=r.attr("data-iterator");a.attr("data-iterator",o).find(b.repeatEls).each(function(){b.updateNameAttr(s(this),n,o)}),r.attr("data-iterator",n).find(b.repeatEls).each(function(){b.updateNameAttr(s(this),o,n)});var c=t.parents(".cmb-repeatable-group").find("[data-grouptitle]").data("grouptitle");c&&(b.resetGroupTitles(a,o,c),b.resetGroupTitles(r,n,c)),r[i?"before":"after"](a),s([d.documentElement,d.body]).animate({scrollTop:a.offset().top-50},300),b.triggerElement(t,"cmb2_shift_rows_complete",t,a,r)}},b.initPickers=function(e,t,i){b.trigger("cmb_init_pickers",{time:e,date:t,color:i}),b.initDateTimePickers(e,"timepicker","time_picker"),b.initDateTimePickers(t,"datepicker","date_picker"),b.initColorPickers(i)},b.initDateTimePickers=function(e,a,r){e.length&&e[a]("destroy").each(function(){var e=s(this),t=e.data(a)||{},i=s.extend({},b.defaults[r],t);e[a](b.datePickerSetupOpts(t,i,a))})},b.datePickerSetupOpts=function(e,t,a){var r=s.extend({},t);return t.beforeShow=function(e,t){"timepicker"===a&&b.addTimePickerClasses(t.dpDiv),l("ui-datepicker-div").addClass("cmb2-element"),"function"==typeof r.beforeShow&&r.beforeShow(e,t)},"timepicker"===a&&(t.onChangeMonthYear=function(e,t,i,a){b.addTimePickerClasses(i.dpDiv),"function"==typeof r.onChangeMonthYear&&r.onChangeMonthYear(e,t,i,a)}),t.onClose=function(e,t){var i=l("ui-datepicker-div").removeClass("cmb2-element").hide();"timepicker"!==a||s(t.input).val()||t.input.val(i.find(".ui_tpicker_time").text()),"function"==typeof r.onClose&&r.onClose(e,t)},t},b.addTimePickerClasses=function(e){var t=b.addTimePickerClasses;t.count=t.count||0,u(function(){e.find(".ui-priority-secondary").length?(e.find(".ui-priority-secondary").addClass("button-secondary"),e.find(".ui-priority-primary").addClass("button-primary"),t.count=0):t.count<5&&(t.count++,t(e))},10)},b.initColorPickers=function(e){e.length&&("object"===_typeof(jQuery.wp)&&"function"==typeof jQuery.wp.wpColorPicker?e.each(function(){var e=s(this),t=e.data("colorpicker")||{};e.wpColorPicker(s.extend({},b.defaults.color_picker,t))}):e.each(function(e){s(this).after('<div id="picker-'+e+'" style="z-index: 1000; background: #EEE; border: 1px solid #CCC; position: absolute; display: block;"></div>'),l("picker-"+e).hide().farbtastic(s(this))}).focus(function(){s(this).next().show()}).blur(function(){s(this).next().hide()}))},b.initCodeEditors=function(e){b.trigger("cmb_init_code_editors",e),b.defaults.code_editor&&wp&&wp.codeEditor&&e.length&&e.each(function(){wp.codeEditor.initialize(this.id,b.codeEditorArgs(s(this).data("codeeditor")))})},b.codeEditorArgs=function(e){var t=["codemirror","csslint","jshint","htmlhint"],i=s.extend({},b.defaults.code_editor);e=e||{};for(var a=t.length-1;0<=a;a--)e.hasOwnProperty(t[a])&&(i[t[a]]=s.extend({},i[t[a]]||{},e[t[a]]));return i},b.makeListSortable=function(){var e=b.metabox().find(".cmb2-media-status.cmb-attach-list");e.length&&e.sortable({cursor:"move"}).disableSelection()},b.makeRepeatableSortable=function(e){var t=(e||b.metabox()).find(".cmb-repeat-table .cmb-field-list");t.length&&t.sortable({items:".cmb-repeat-row",cursor:"move",cancel:"input,textarea,button,select,option,.CodeMirror"})},b.maybeOembed=function(i){var t=s(this);({focusout:function(){u(function(){b.spinner(".cmb2-metabox",!0)},2e3)},keyup:function(){function e(e,t){return i.which<=t&&i.which>=e}(e(48,90)||e(96,111)||e(8,9)||187===i.which||190===i.which)&&b.doAjax(t,i)},paste:function(){u(function(){b.doAjax(t)},100)}})[i.type]()},b.resizeoEmbeds=function(){b.metabox().each(function(){var e=s(this),t=e.parents(".inside"),i=e.parents(".inner-sidebar").length||e.parents("#side-sortables").length,n=i,a=!1;if(!t.length)return!0;var o=t.width();b.styleBreakPoint>o&&(n=!0,a=b.styleBreakPoint-62>o);var c=(o=n?o:Math.round(.82*t.width()*.97))-30;if(!n||i||a||(c-=75),639<c)return!0;var r=e.find(".cmb-type-oembed .embed-status").children().not(".cmb2-remove-wrapper");if(!r.length)return!0;r.each(function(){var e=s(this),t=e.width(),i=e.height(),a=c;e.parents(".cmb-repeat-row").length&&!n&&(a=c-91,a=o<785?a-15:a);var r=Math.round(a*i/t);e.width(a).height(r)})})},b.doAjax=function(e){var t=e.val();if(!(t.length<6)){var i=e.attr("id"),a=e.closest(".cmb-td"),r=a.find(".embed-status"),n=a.find(".embed_wrap"),o=r.find(":first-child"),c=r.length&&o.length?o.width():e.width();b.log("oembed_url",t,i),b.spinner(a),n.html(""),u(function(){s(".cmb2-oembed:focus").val()===t&&s.ajax({type:"post",dataType:"json",url:p.ajaxurl,data:{action:"cmb2_oembed_handler",oembed_url:t,oembed_width:300<c?c:300,field_id:i,object_id:e.data("objectid"),object_type:e.data("objecttype"),cmb2_ajax_nonce:p.ajax_nonce},success:function(e){b.log(e),b.spinner(a,!0),n.html(e.data)}})},500)}},b.metabox=function(){return b.$metabox||(b.$metabox=s(".cmb2-wrap > .cmb2-metabox")),b.$metabox},b.spinner=function(e,t){var i=t?"removeClass":"addClass";s(".cmb-spinner",e)[i]("is-active")},b.trigger=function(e){var t=Array.prototype.slice.call(arguments,1);t.push(b),i.trigger(e,t)},b.triggerElement=function(e,t){var i=Array.prototype.slice.call(arguments,2);i.push(b),e.trigger(t,i)},b.getFieldArg=function(e,t){return b.getField(e)[t]},b.getFields=function(i){if("function"!=typeof i)return p.fields;var a=[];return s.each(p.fields,function(e,t){i(t,e)&&a.push(t)}),a},b.getField=function(t){var i={};if(t=t instanceof jQuery?t.data("hash"):t)try{if(p.fields[t])throw new Error(t);b.getFields(function(e){if("function"==typeof t){if(t(e))throw new Error(e.hash)}else if(e.id&&e.id===t)throw new Error(e.hash)})}catch(e){i=p.fields[e.message]}return i},b.log=function(){p.script_debug&&console&&"function"==typeof console.log&&console.log.apply(console,arguments)},b.replaceLast=function(e,t,i){var a=e.lastIndexOf(t);return e.slice(0,a)+e.slice(a).replace(t,i)},s(b.init)}(window,document,jQuery,window.CMB2);
